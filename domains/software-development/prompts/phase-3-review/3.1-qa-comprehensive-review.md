# Prompt: QA Comprehensive Code Review

**Persona:** QA Engineer
**Phase:** 3 - Review and Refactoring
**Purpose:** Holistic code review across all quality dimensions

---

## When to Use This Prompt

‚úÖ **Use when:** You've completed a feature/task and want broad feedback before merging
‚ùå **Don't use when:** You want deep analysis of one specific aspect (use specialized prompts 3.2-3.5)

---

## The Prompt Template

```markdown
You are a Senior QA Engineer. Review the **[PRIMARY_LANGUAGE]** code in the following files:

[FILE_PATHS_TO_REVIEW]

**Rules:**
1. You MUST check for violations against the attached `CONSTITUTION.md`
2. You MUST explain your reasoning for every suggestion
3. Provide specific file names and line numbers for all issues
4. Categorize issues by severity: CRITICAL, HIGH, MEDIUM, LOW

**Review Dimensions:**
Consider the following 5 dimensions of code quality:

1. **Code Quality & Best Practices**
   - Adherence to standards (CONSTITUTION.md)
   - Code smells and anti-patterns
   - DRY (Don't Repeat Yourself)
   - SOLID principles
   - Naming conventions

2. **Potential Bugs or Edge Cases**
   - Logic flaws
   - Off-by-one errors
   - Null/undefined handling
   - Empty collections
   - Boundary conditions
   - Race conditions

3. **Performance Optimizations**
   - N+1 query problems
   - Inefficient loops or algorithms
   - Unnecessary re-renders (frontend)
   - Missing database indexes
   - Memory leaks
   - Blocking operations

4. **Readability & Maintainability**
   - Code complexity
   - Function length
   - Nested conditions
   - Magic numbers/strings
   - Comment quality
   - Code duplication

5. **Security Concerns**
   - SQL injection
   - XSS (Cross-Site Scripting)
   - Authentication/authorization flaws
   - Sensitive data exposure
   - Insecure dependencies
   - Missing input validation

**Output Format:**
Provide a structured review addressing each dimension separately. For each issue:
- Severity level (üî¥ CRITICAL, üü† HIGH, üü° MEDIUM, üü¢ LOW)
- File and line number
- Clear description
- Why it's an issue
- Suggested fix (with code example if possible)

Also identify **strengths** (what was done well).

---

**Files to Read:**
- Code files to review (specify paths)
- `CONSTITUTION.md`
- (Optional) Related code for context
```

---

## Quick Start Guide

### Step 1: Prepare Code
- [ ] Code is complete for the task
- [ ] You've tested it manually
- [ ] It runs without errors

### Step 2: Fill Template Variables
- Replace `[PRIMARY_LANGUAGE]` ‚Üí e.g., "Python", "TypeScript"
- Replace `[FILE_PATHS_TO_REVIEW]` ‚Üí List file paths (e.g., "src/services/password-reset.service.ts")

### Step 3: Invoke AI
The AI will read:
- The specified code files
- CONSTITUTION.md
- Any related context files from the codebase

### Step 4: Address Issues by Priority

**Priority order:**
1. üî¥ **CRITICAL** - Fix immediately (security, crashes, data loss)
2. üü† **HIGH** - Fix before merging (bugs, missing error handling)
3. üü° **MEDIUM** - Fix this iteration (edge cases, quality issues)
4. üü¢ **LOW** - Fix when convenient (nitpicks, small optimizations)

### Step 5: Re-test After Fixes
- [ ] All CRITICAL issues fixed
- [ ] All HIGH issues fixed
- [ ] Code re-tested
- [ ] Linters/formatters pass

---

## Severity Level Guide

### üî¥ CRITICAL
- Security vulnerabilities (SQL injection, XSS, auth bypass)
- Data loss or corruption
- Application crashes
- **Action:** Fix before deploying

### üü† HIGH
- Bugs affecting core functionality
- Major performance issues
- Missing critical error handling
- **Action:** Fix before merging

### üü° MEDIUM
- Edge case bugs
- Code quality issues
- Non-critical optimizations
- **Action:** Fix this iteration

### üü¢ LOW
- Minor style issues
- Small optimizations
- Nitpicks
- **Action:** Fix when convenient

---

## Template Variables Reference

| Variable | Filled By | Example |
|----------|-----------|---------|
| `[PRIMARY_LANGUAGE]` | AI (from CONSTITUTION.md) | "Python", "TypeScript" |
| `[FILE_PATHS_TO_REVIEW]` | Human at use-time | "src/services/password-reset.service.ts" |

---

## Common Issues the QA Engineer Should Find

**Security:**
- SQL injection (string concatenation in queries)
- Weak tokens (predictable, not cryptographically secure)
- Plain text storage of sensitive data
- Email enumeration attacks
- Missing rate limiting

**Bugs:**
- Null/undefined handling
- Array index out of bounds
- Division by zero
- Off-by-one errors
- Race conditions

**Performance:**
- N+1 queries
- Missing indexes
- Inefficient loops
- Unnecessary database calls

**Quality:**
- Missing error handling
- No function documentation
- Magic numbers/strings
- Overly complex functions

---

## After Review Checklist

- [ ] All CRITICAL issues fixed
- [ ] All HIGH issues fixed
- [ ] MEDIUM issues fixed or scheduled
- [ ] Code re-tested after fixes
- [ ] Linters/formatters pass
- [ ] Tests still pass
- [ ] (Optional) Re-run review to verify

---

## Next Steps

After addressing issues:

1. **For minor issues:** Move to Phase 4 (Documentation)
2. **For major refactoring:** Use [3.6-architect-refactor-consultation.md](./3.6-architect-refactor-consultation.md)
3. **For specific concerns:** Use specialized review prompts:
   - [3.2 - Bugs & Edge Cases](./3.2-qa-bugs-edge-cases.md)
   - [3.3 - Security Audit](./3.3-qa-security-audit.md)
   - [3.4 - Style & Standards](./3.4-qa-style-standards.md)
   - [3.5 - Testability](./3.5-qa-testability.md)

---

## Related Resources

- [QA Engineer Persona](../../personas/04-qa-engineer.md)
- [Detailed review examples](../../examples/review-examples.md)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- Previous: [Code Commenter](../phase-2-implementation/2.3-code-commenter.md)
- Next: [Documentation](../phase-4-documentation/4.1-readme-generator.md)
